--- ncurses-5.4/ncurses/widechar/lib_cchar.c.orig	2004-09-27 23:10:47.113467830 +0200
+++ ncurses-5.4/ncurses/widechar/lib_cchar.c	2004-09-27 23:14:13.220833629 +0200
@@ -79,7 +79,7 @@
 	memset(wcval, 0, sizeof(*wcval));
 
 	if (len != 0) {
-	    SetAttr(*wcval, attrs | color_pair);
+	    SetAttr(*wcval, attrs | COLOR_PAIR(color_pair));
 	    memcpy(&wcval->chars, wch, len * sizeof(wchar_t));
 	    TR(TRACE_CCALLS, ("copy %d wchars, first is %s", len,
 			      _tracecchar_t(wcval)));
@@ -114,8 +114,8 @@
 	} else if (attrs == 0 || color_pair == 0) {
 	    code = ERR;
 	} else if (len >= 0) {
-	    *attrs = AttrOf(*wcval);
-	    *color_pair = AttrOf(*wcval) & A_COLOR;
+	    *attrs = AttrOf(*wcval) & A_ATTRIBUTES;
+	    *color_pair = PAIR_NUMBER(AttrOf(*wcval));
 	    wmemcpy(wch, wcval->chars, (unsigned) len);
 	    wch[len] = L'\0';
 	    code = OK;
